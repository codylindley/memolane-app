<!doctype html>

<!--[if IE 8]><html class="ie8 no-js" lang="en"><![endif]-->
<!--[if IE 9]><html class="ie9 no-js" lang="en"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
  <meta charset="utf-8">

	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
	   Remove this if you use the .htaccess -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title><%= i18n("Memolane | See, search, and share your life", "The memolane Catchphrase") %></title>
	
	<meta name="title" content='<%= i18n("Memolane | See, search, and share your life", "The memolane Catchphrase") %>' />
	
	<meta name="description" content='<%= i18n("Keep your memories alive. Capture photos, music, tweets, posts, and much more. View and share your entire online life in one place. Explore and search your history. One timeline, a million memories.") %>' />
	
	<!-- Tablet Optimized -->
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	
	<!-- Place favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
	<link rel="shortcut icon" href="/favicon.ico">
	<link rel="apple-touch-icon" href="/apple-touch-icon.png">
	
	<!-- CSS: implied media="all" -->
        <% if env["compact"] != 0 and ( ["production", "staging", "m2"].include?( ENV["RACK_ENV"] ) or env["compact"] == 1 ) %>
        <%= include_css_bundle "settings.css" %>
        <% else %> 
	<link rel="stylesheet" href="/css/reset.css">
	<link rel="stylesheet" href="/css/defaults.css">
	<link rel="stylesheet" href="/css/common.css">
		<!-- CSS modules used on this page -->
	<link rel="stylesheet" href="/css/modules/utilityNav.css">
	<link rel="stylesheet" href="/css/modules/search.css">
	<link rel="stylesheet" href="/css/modules/topBar.css">
	<link rel="stylesheet" href="/css/modules/headings.css">
	<link rel="stylesheet" href="/css/modules/buttons.css">
	<link rel="stylesheet" href="/css/modules/buttonBars.css">
	<link rel="stylesheet" href="/css/modules/topBarDropDowns.css">
	<link rel="stylesheet" href="/css/modules/header.css">
	<link rel="stylesheet" href="/css/modules/dialogs.css">
	<link rel="stylesheet" href="/css/modules/validation.css">
	<link rel="stylesheet" href="/css/modules/language.css">
		<!-- Page Specific CSS -->
	<link rel="stylesheet" href="/css/modules/mySettings.css">
	<% end %>
	
<!-- start Mixpanel -->
<script type="text/javascript">
   mpq=[];mpq.push(["init","<%= MIXPANEL_KEY %>"]);(function(){var b,a,e,d,c;b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=(document.location.protocol==="https:"?"https:":"http:")+"//api.mixpanel.com/site_media/js/api/mixpanel.js";a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a);e=function(f){return function(){mpq.push([f].concat(Array.prototype.slice.call(arguments,0)))}};d=["init","track","track_links","track_forms","register","register_once","identify","name_tag","set_config"];for(c=0;c<d.length;c++){mpq[d[c]]=e(d[c])}})();
</script>
<!-- end Mixpanel -->    	
  	  		
	<!-- Memolane namespace -->
	<script type="text/javascript">
	/*-----------------------------
	setup application namespace
	-----------------------------*/
	window.memolane = {};
	//setup shortcut
	window.m = memolane;
	</script>

</head>

<body>

<div id="header" class="more1024">
<%= partial 'includes/utilityNav', @includes %>
<%= partial 'includes/topBar', @includes %>
</div>


<div id="content">
	
	<div id="innerContent">
	
		<h2 class="header typeA"><%= i18n("My Settings", "Heading on settings page") %></h2>
		
		<ul class="settings-tab-nav">
			<li><a href="/settings/account" class="settings-account current"><%= i18n("My Account", "category on settings page") %></a></li>
			<li><a href="/settings/notifications" class="settings-notifications"><%= i18n("Notifications", "category on settings page") %></a></li>
			<li><a href="/settings/music" class="settings-music"><%= i18n("Music Playback", "category on settings page") %></a></li>
			<!--<li><a href="/settings/international" class="settings-international">International</a></li>-->
		</ul>
		
		<div class="settings-main">
			
				<fieldset>
					<div class="float-left" style="margin:0 20px 10px 0;position:relative;">
					<div id="avatar-user-loader"></div>
					<div id="change-avatar-btn-position">
						<a href="#" id="add-edit-user-avatar" class="btn-grey"><%= i18n("change","change lane avatar lane") %></a>
						<input type="file" name="img_raw" class="user-upload-input-file" />
					</div>
						<img src="<%= "#{current_user.username}/image.large?noCacheImage=#{Time.now().to_i}" %>" style="border:1px solid #ccc;" class="user-avatar" width="140px" />
					</div>
					<div id="user-avatar-copy"><%= i18n("For best results please choose a photo that has a<br /> minimum height & width of 140px") %></div>
				</fieldset>
				<form class="settingsForm" id="settingsFormAccount" action="" enctype="multipart/form-data">
				<fieldset>
					<label>
						<%= i18n("First Name", "name of edit field on settings/signup page") %>
						<input type="text" name="firstName" id="settingsFirstName" class="required" value="<%= h current_user.first_name %>" />
					</label>
					<label>
						<%= i18n("Last Name", "name of edit field on settings/signup page") %>
						<input type="text" name="lastName" id="settingsLastName" class="required" value="<%= current_user.last_name%>" />
					</label>
				</fieldset>
				<fieldset>
					<label>
						<%= i18n("Email", "name of edit field on settings/signup page") %>
						<input type="text" name="email" id="settingsEmail" class="required email" value="<%= current_user.email%>" />
					</label>
					<label>
						<em style="font-weight:normal; text-decoration:none; color:#a1a1a1;">memolane.com/</em><em id="settingsUsernameDisplay"><%= current_user.username%></em>
						<input type="text" name="username" id="settingsUsername" class="required" value="<%= current_user.username%>" />
					</label>
				</fieldset>
				<fieldset>
					<label>
						<%= i18n("Bio &#151; tell everyone a bit about yourself and how you spend your time", "biography, name of edit field on settings page") %>
						<textarea name="bio" id="settingsBio"><%= current_user.bio%></textarea>
					</label>
				</fieldset>
				<fieldset>
					<label>
						<%= i18n("Change Password", "name of edit field on settings page") %>
						<input type="password" name="newPassword" id="settingsNewPassword" style="width:164px; margin-right:10px; margin-bottom:3px;" />
					</label>
					<p class="text typeE clear"><%= i18n("Passwords must be a minimum of 8 characters.", "error message ons ettings page if new password is too short") %></p>
				</fieldset>
				<fieldset>
					<h3 style="font-weight:bold; color:#353535; font-weight:bold; margin-bottom:15px;"><%= i18n("Delete Account", "Heading for deleting your account") %></h3>
					<p class="text typeA"><%= i18n("Deleting your Memolane account will permanently erase all of your lanes, memos, and friend connections on Memolane.com &#151; to proceed <a href=\'#\' id=\'deleteAccount\'>click here</a>.", "description and link to delete memolane account") %></p>
				</fieldset>
				<div id="form-actions">
					<input type="submit" value='<%= i18n("Save", "Save button on settings pages") %>' class="btn-green float-left" />
					<div class="form-message form-message-processing">
						<%= i18n("Saving...", "Status text when saving of settings is in progress" ) %>
					</div>
					<div class="form-message form-message-success">
						<%= i18n("Saved!", "Status text when saving of settings is complete" ) %>
					</div>
					<div class="form-message form-message-error">
						<%= i18n("Error!", "Status text when saving of settings failed" ) %>
					</div>
				</div>
			</form>
			<div id="settings-main-bottom-left-fade">&nbsp;</div>
		</div>

	</div>
	
</div>


<!-- DROPDOWNS  -->
<%= partial 'includes/topBarDropDowns', @includes %>
<%= partial 'includes/topBarSearchDropDowns', @includes %>

<!-- translation from english, CAN'T be bundles, must be load before eveything -->
<script src="/lang.js"></script>

<!-- Thirdparty Scripts -->
<%= partial 'includes/jsThirdParty', @includes %>

<!-- JS for just this html page  -->
<script type="text/javascript">
	m.csrf = "<%= Rack::Csrf.csrf_token(env) %>";
	<% if current_user %>
	m.currentUser = {
		userID : "<%= current_user.id %>",
		username : "<%= current_user.username%>",
		email : "<%= current_user.email%>",
		firstname : "<%= current_user.first_name%>",
		lastname: "<%= current_user.last_name%>",
		avatar : "<%= "#{current_user.username}/image" %>",
                requires_pw : <%= "#{current_user.password_hash != nil}" %>
	};
	<% else %>
	m.currentUser = null;
	<% end %>	
    m.currentLanguage = '<%= session["language"] %>';
</script>


<% if env["compact"] != 0 and ( ["production", "staging", "m2"].include?( ENV["RACK_ENV"] ) or env["compact"] == 1 ) %>
<%= include_js_bundle "settings.js" %>
<% else %> 

<!-- Memolane application setup / modules -->
<script src="/js/utilities.js"></script>
<script src="/js/globalTemplates.js"></script>
<script src="/js/appSetup.js"></script>

<!-- Start adding modules to be used on this page -->
<script src="/js/modules/language.js"></script>
<script src="/js/modules/topBar.js"></script>
<script src="/js/modules/topBarDropDowns.js"></script>
<script src="/js/modules/addFriends.js"></script>
<script src="/js/modules/search.js"></script>
<script src="/js/modules/settings.js"></script>
<script src="/js/modules/share.js"></script>
<!-- /End modules to be used on this page -->

<script src="/js/runApp.js"></script>
  
<% end %>

<!--Uservoice-->
<%= include_uservoice_js %>

<!--GOOGLE ANALYTICS-->
<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-18503349-1']);
 _gaq.push(['_setDomainName', '.memolane.com']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();

</script>

<% if current_user %>
<!-- Mixpanel -->
<script type="text/javascript">
mpq.name_tag('<%= current_user.username%>'); 
</script>
<!-- Mixpanel -->
<% end %>
  
</body>
</html>